<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>ã‚­ãƒ©ã‚­ãƒ©ï¼ã•ã‚“ã™ã†ãƒ‰ãƒªãƒ«</title>
	<style>
		:root {
			--primary-color: #ff6b6b;
			--secondary-color: #4ecdc4;
			--accent-color: #feca57;
			--bg-color: #f0f4f8;
		}

		body {
			font-family: 'Hiragino Sans', 'Meiryo', sans-serif;
			background-color: var(--bg-color);
			margin: 0;
			display: flex;
			justify-content: center;
			align-items: center;
			min-height: 100vh;
			touch-action: manipulation; /* é€£æ‰“æ™‚ã®ã‚ºãƒ¼ãƒ é˜²æ­¢ */
		}

		#app {
			background: white;
			width: 95%;
			max-width: 400px;
			padding: 20px;
			border-radius: 30px;
			box-shadow: 0 15px 35px rgba(0,0,0,0.1);
			text-align: center;
			border: 6px solid var(--secondary-color);
			position: relative;
		}

		/* ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ã‚¹ã‚¤ãƒƒãƒ */
		.mode-selector {
			display: flex;
			gap: 10px;
			justify-content: center;
			margin-bottom: 15px;
		}

		.mode-btn {
			padding: 8px 15px;
			border-radius: 20px;
			border: 2px solid #ddd;
			background: white;
			cursor: pointer;
			font-weight: bold;
		}

		.mode-btn.active {
			background: var(--accent-color);
			border-color: var(--accent-color);
			color: white;
		}

		.stats { display: flex; justify-content: space-between; font-weight: bold; color: #666; margin-bottom: 10px; }

		.question-area {
			font-size: 3.5rem;
			margin: 20px 0;
			font-weight: 900;
			color: #333;
			min-height: 80px;
		}

		.input-display {
			font-size: 3rem;
			height: 70px;
			line-height: 70px;
			background: #f9f9f9;
			border-radius: 15px;
			margin-bottom: 20px;
			border-bottom: 5px solid #ddd;
		}

		.numpad {
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			gap: 12px;
		}

		button {
			padding: 18px;
			font-size: 1.6rem;
			border: none;
			border-radius: 18px;
			background: #fff;
			box-shadow: 0 4px 0 #ddd;
			cursor: pointer;
			transition: 0.1s;
		}

		button:active { transform: translateY(4px); box-shadow: none; }

		.btn-number { border: 2px solid #f0f0f0; }
		.btn-enter { background: var(--secondary-color); color: white; grid-column: span 2; box-shadow: 0 4px 0 #3db8af; }
		.btn-clear { background: var(--primary-color); color: white; box-shadow: 0 4px 0 #e65b5b; }

		/* ã‚­ãƒ©ã‚­ãƒ©æ¼”å‡ºç”¨ */
		.particle {
			position: absolute;
			pointer-events: none;
			z-index: 100;
		}

		.result-screen { display: none; }
		.result-screen h2 { color: var(--primary-color); font-size: 2rem; }
	</style>
</head>
<body>

<div id="app">
	<div id="game-screen">
		<div class="mode-selector">
			<button class="mode-btn active" id="mode-plus" onclick="setMode('plus')">ãŸã—ã–ã‚“</button>
			<button class="mode-btn" id="mode-minus" onclick="setMode('minus')">ã²ãã–ã‚“</button>
		</div>

		<div class="stats">
			<span>ã®ã“ã‚Š: <span id="remaining">10</span></span>
			<span>ã›ã„ã‹ã„: <span id="score">0</span></span>
		</div>

		<div class="question-area" id="question">?-?</div>
		<div class="input-display" id="answer-input"></div>

		<div class="numpad">
			<button class="btn-number" onclick="addNum(1)">1</button>
			<button class="btn-number" onclick="addNum(2)">2</button>
			<button class="btn-number" onclick="addNum(3)">3</button>
			<button class="btn-number" onclick="addNum(4)">4</button>
			<button class="btn-number" onclick="addNum(5)">5</button>
			<button class="btn-number" onclick="addNum(6)">6</button>
			<button class="btn-number" onclick="addNum(7)">7</button>
			<button class="btn-number" onclick="addNum(8)">8</button>
			<button class="btn-number" onclick="addNum(9)">9</button>
			<button class="btn-clear" onclick="clearInput()">C</button>
			<button class="btn-number" onclick="addNum(0)">0</button>
			<button class="btn-enter" onclick="checkAnswer()">ã“ãŸãˆã‚‹ï¼</button>
		</div>
	</div>

	<div id="result-screen" class="result-screen">
		<h2>ğŸ‰ ã™ã”ã„ï¼ ğŸ‰</h2>
		<p id="final-score" style="font-size: 1.5rem; font-weight: bold;"></p>
		<button onclick="location.reload()" style="background: var(--accent-color); color:white; width:100%; box-shadow: 0 4px 0 #e6af2e;">ã‚‚ã†ã„ã¡ã© ã‚„ã‚‹ï¼</button>
	</div>
</div>

<script>
	let num1, num2, correctAnswer, mode = 'plus';
	let score = 0, count = 0, maxQuestions = 10;
	let currentInput = "";

	function setMode(newMode) {
		mode = newMode;
		document.getElementById('mode-plus').classList.toggle('active', mode === 'plus');
		document.getElementById('mode-minus').classList.toggle('active', mode === 'minus');
		resetGame();
	}

	function resetGame() {
		score = 0; count = 0; currentInput = "";
		document.getElementById('score').innerText = "0";
		document.getElementById('remaining').innerText = maxQuestions;
		generateQuestion();
	}

	function generateQuestion() {
		currentInput = "";
		updateDisplay();
		
		if (mode === 'plus') {
			num1 = Math.floor(Math.random() * 9) + 1;
			num2 = Math.floor(Math.random() * 9) + 1;
			correctAnswer = num1 + num2;
			document.getElementById('question').innerText = `${num1} + ${num2}`;
		} else {
			// å¼•ãç®—ã¯ç­”ãˆãŒãƒã‚¤ãƒŠã‚¹ã«ãªã‚‰ãªã„ã‚ˆã†ã«èª¿æ•´
			num1 = Math.floor(Math.random() * 15) + 5;
			num2 = Math.floor(Math.random() * num1) + 1;
			correctAnswer = num1 - num2;
			document.getElementById('question').innerText = `${num1} - ${num2}`;
		}
	}

	function addNum(n) {
		if (currentInput.length < 3) {
			currentInput += n;
			updateDisplay();
		}
	}

	function clearInput() {
		currentInput = "";
		updateDisplay();
	}

	function updateDisplay() {
		document.getElementById('answer-input').innerText = currentInput;
	}

	function checkAnswer() {
		if (currentInput === "") return;
		const userAnswer = parseInt(currentInput);

		if (userAnswer === correctAnswer) {
			createSparkles();
			score++;
		}
		
		count++;
		document.getElementById('score').innerText = score;
		document.getElementById('remaining').innerText = maxQuestions - count;

		if (count < maxQuestions) {
			setTimeout(generateQuestion, 400);
		} else {
			setTimeout(showResult, 600);
		}
	}

	// ã‚­ãƒ©ã‚­ãƒ©ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
	function createSparkles() {
		for (let i = 0; i < 20; i++) {
			const particle = document.createElement('div');
			particle.className = 'particle';
			particle.innerText = ['â­', 'âœ¨', 'ğŸˆ', 'ğŸŒ¸'][Math.floor(Math.random() * 4)];
			particle.style.left = '50%';
			particle.style.top = '40%';
			particle.style.fontSize = (Math.random() * 20 + 20) + 'px';
			document.body.appendChild(particle);

			const destinationX = (Math.random() - 0.5) * 400;
			const destinationY = (Math.random() - 0.5) * 400;

			const animation = particle.animate([
				{ transform: 'translate(-50%, -50%) scale(1)', opacity: 1 },
				{ transform: `translate(${destinationX}px, ${destinationY}px) scale(0)`, opacity: 0 }
			], {
				duration: 800 + Math.random() * 400,
				easing: 'cubic-bezier(0, .9, .57, 1)'
			});

			animation.onfinish = () => particle.remove();
		}
	}

	function showResult() {
		document.getElementById('game-screen').style.display = 'none';
		document.getElementById('result-screen').style.display = 'block';
		document.getElementById('final-score').innerText = `${maxQuestions}ã‚‚ã‚“ä¸­ ${score}ã‚‚ã‚“ ã›ã„ã‹ã„ï¼`;
	}

	generateQuestion();
</script>

</body>
</html>
